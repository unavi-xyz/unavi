[workspace]
members  = ["crates/*", "wasm/*"]
resolver = "2"

[workspace.package]
edition    = "2024"
license    = "MPL-2.0"
repository = "https://github.com/unavi-xyz/unavi"
version    = "0.0.14"

[workspace.lints.clippy]
cast_possible_truncation = "allow"
cast_precision_loss      = "allow"
cast_sign_loss           = "allow"
nursery                  = { level = "warn", priority = -1 }
pedantic                 = { level = "warn", priority = -1 }
unwrap_used              = "deny"

# Bevy-specific patterns
needless_pass_by_value = "allow"
too_many_arguments     = "allow"
type_complexity        = "allow"

# wit-bindgen generated code
collection_is_never_read = "allow"

[workspace.metadata.release]
publish        = false
shared-version = true
tag-name       = "v{{version}}"

[workspace.dependencies]
anyhow             = "1.0.100"
avian3d            = "0.4.1"
bevy               = "0.17.3"
bevy_async_task    = "0.9.0"
bevy_gltf_kun      = { git = "https://github.com/unavi-xyz/gltf_kun" }
bevy_vrm           = { git = "https://github.com/unavi-xyz/bevy_vrm" }
bincode            = "2.0.1"
clap               = { features = ["derive"], version = "4.5.51" }
constcat           = "0.6.1"
directories        = "6.0.0"
dwn                = { git = "https://github.com/unavi-xyz/dwn" }
dwn-server         = { git = "https://github.com/unavi-xyz/dwn" }
embed-resource     = "3.0.6"
flume              = "0.11.0"
futures            = "0.3.31"
gltf_kun           = { git = "https://github.com/unavi-xyz/gltf_kun" }
image              = { default-features = false, version = "0.25.8" }
parking_lot        = "0.12.5"
scc                = "3.4.2"
semver             = "1.0.27"
serde              = "1.0.228"
serde_json         = "1.0.145"
serde_vrm          = { git = "https://github.com/unavi-xyz/bevy_vrm" }
smallvec           = "1.15.1"
tarpc              = "0.37.0"
tokio              = "1.48.0"
tokio-serde        = "0.9.0"
tracing            = "0.1.41"
tracing-subscriber = "0.3.20"
tracing-test       = { features = ["no-env-filter"], version = "0.2.5" }
wit-bindgen        = "0.48.1"
wtransport         = "0.6.1"
xdid               = { git = "https://github.com/unavi-xyz/dwn" }
zeroize            = "1.8.2"

[patch.crates-io]
bevy_gltf_kun = { git = "https://github.com/unavi-xyz/gltf_kun" }
bevy_vrm      = { git = "https://github.com/unavi-xyz/bevy_vrm" }
dwn           = { git = "https://github.com/unavi-xyz/dwn" }
dwn-server    = { git = "https://github.com/unavi-xyz/dwn" }
gltf_kun      = { git = "https://github.com/unavi-xyz/gltf_kun" }
xdid          = { git = "https://github.com/unavi-xyz/dwn" }

[profile.release]
codegen-units = 1
lto           = true
panic         = "abort"
strip         = true

[profile.release-wasm]
inherits  = "release"
opt-level = "z"

[profile.dev]
codegen-backend = "cranelift"

[profile.dev.package."*"]
codegen-backend = "llvm"

[profile.wasm-dev]
inherits  = "dev"
opt-level = 1

# Generated by Dioxus
[profile.server-dev]
inherits = "dev"

[profile.android-dev]
inherits = "dev"
